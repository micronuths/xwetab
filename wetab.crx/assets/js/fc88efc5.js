/*! For license information please see fc88efc5.js.LICENSE.txt */
"use strict";(globalThis.webpackChunkinfinity_hitab_client=globalThis.webpackChunkinfinity_hitab_client||[]).push([[6201],{13409:(e,t,a)=>{a.d(t,{o7:()=>F,t4:()=>M,O9:()=>D,f8:()=>G,dJ:()=>L,zY:()=>k,hQ:()=>z,XM:()=>C,ST:()=>Y});var i=a(994),s=a(80661),r=a.n(s),n=a(74003),o=a(63477),h=a(55332);let d;try{new EventTarget,d=!0}catch(e){d=!1}var l=d?EventTarget:class{constructor(){this.e={}}addEventListener(e,t,a=!1){this.t(e).push(t)}removeEventListener(e,t,a=!1){const i=this.t(e),s=i.indexOf(t);s>-1&&i.splice(s,1)}dispatchEvent(e){return e.target=this,Object.freeze(e),this.t(e.type).forEach((t=>t(e))),!0}t(e){return this.e[e]=this.e[e]||[]}};var c=d?Event:class{constructor(e){this.type=e}};class g extends c{constructor(e,t){super(e),this.newState=t.newState,this.oldState=t.oldState,this.originalEvent=t.originalEvent}}const u="active",b="passive",f="hidden",m="frozen",v="terminated",w="object"==typeof safari&&safari.pushNotification,y=["focus","blur","visibilitychange","freeze","resume","pageshow","onpageshow"in self?"pagehide":"unload"],p=e=>(e.preventDefault(),e.returnValue="Are you sure?"),V=[[u,b,f,v],[u,b,f,m],[f,b,u],[m,f],[m,u],[m,b]].map((e=>e.reduce(((e,t,a)=>(e[t]=a,e)),{}))),O=()=>document.visibilityState===f?f:document.hasFocus()?u:b;var E=new class extends l{constructor(){super();const e=O();this.s=e,this.i=[],this.a=this.a.bind(this),y.forEach((e=>addEventListener(e,this.a,!0))),w&&addEventListener("beforeunload",(e=>{this.n=setTimeout((()=>{e.defaultPrevented||e.returnValue.length>0||this.r(e,f)}),0)}))}get state(){return this.s}get pageWasDiscarded(){return document.wasDiscarded||!1}addUnsavedChanges(e){!this.i.indexOf(e)>-1&&(0===this.i.length&&addEventListener("beforeunload",p),this.i.push(e))}removeUnsavedChanges(e){const t=this.i.indexOf(e);t>-1&&(this.i.splice(t,1),0===this.i.length&&removeEventListener("beforeunload",p))}r(e,t){if(t!==this.s){const a=((e,t)=>{for(let a,i=0;a=V[i];++i){const i=a[e],s=a[t];if(i>=0&&s>=0&&s>i)return Object.keys(a).slice(i,s+1)}return[]})(this.s,t);for(let t=0;t<a.length-1;++t){const i=a[t],s=a[t+1];this.s=s,this.dispatchEvent(new g("statechange",{oldState:i,newState:s,originalEvent:e}))}}}a(e){switch(w&&clearTimeout(this.n),e.type){case"pageshow":case"resume":this.r(e,O());break;case"focus":this.r(e,u);break;case"blur":this.s===u&&this.r(e,O());break;case"pagehide":case"unload":this.r(e,e.persisted?m:v);break;case"visibilitychange":this.s!==m&&this.s!==v&&this.r(e,O());break;case"freeze":this.r(e,m)}}};const T=E,D={font:["rgba(248, 248, 248, 1)","rgba(28, 28, 30, 1)","rgba(58, 58, 60, 1)","rgba(95, 95, 99, 1)","rgba(142, 142, 147, 1)","rgba(176, 176, 182, 1)","rgba(199, 199, 204, 1)"],background:["rgba(248, 248, 248, 1)","rgba(58, 58, 60, 1)","rgba(28, 28, 30, 1)","rgba(244, 171, 18, 1)","rgba(74, 197, 92, 1)","rgba(35, 207, 168, 1)","rgba(67, 133, 241, 1)","rgba(56, 100, 255, 1)","rgba(118, 33, 249, 1)","rgba(224, 78, 150, 1)","rgba(224, 78, 78, 1)","rgba(253, 90, 90, 1)","rgba(183, 163, 150, 1)","rgba(171, 131, 131, 1)","rgba(182, 150, 135, 1)","rgba(109, 131, 95, 1)","rgba(125, 171, 136, 1)","rgba(158, 172, 175, 1)","rgba(103, 124, 170, 1)"]},S=["rgba(183, 163, 150, 1)","rgba(171, 131, 131, 1)","rgba(182, 150, 135, 1)","rgba(109, 131, 95, 1)","rgba(125, 171, 136, 1)","rgba(158, 172, 175, 1)","rgba(103, 124, 170, 1)"],k=()=>(0,i.Z)(S),M=Array(20).fill(0).map(((e,t)=>{const a=`${t+1}`.padStart(2,"0");return{bgImage:{large:`${GlobalGetApi}${n.c1}/widget-background/background${a}_larg.jpg`,medium:`${GlobalGetApi}${n.c1}/widget-background/background${a}_medium.jpg`,small:`${GlobalGetApi}${n.c1}/widget-background/background${a}_small.jpg`},thumbnail:`${GlobalGetApi}${n.c1}/widget-background/background${a}.jpg`}})),I=(e,t)=>{let a=!1;e.isLeapYear()&&1===e.month()&&29===e.date()&&(a=!0);let i=(0,o.sG)(e.format(`${t}-MM-DD`));return a&&!i.isLeapYear()&&(i=i.add(-1,"day")),i.valueOf()>=_.valueOf()||(i=(0,o.sG)(e.format(`${t+1}-MM-DD`)),a&&!i.isLeapYear()&&(i=i.add(-1,"day"))),i},$=e=>{const t=h.q7.fromDate(new Date(e)),a=h.q7.fromDate(new Date).getYear(),i=r()((0,o.EJ)({year:a,month:t.getMonth(),day:t.getDay()}));return i.valueOf()>=_.valueOf()?i:r()((0,o.EJ)({year:a+1,month:t.getMonth(),day:t.getDay()}))},x=e=>{if(e.date()>=_.date())return(0,o.sG)(`${_.year()}-${_.month()+1}-${Math.min(_.daysInMonth(),e.date())}`);const t=_.add(1,"month");return(0,o.sG)(`${t.year()}-${t.month()+1}-${Math.min(t.daysInMonth(),e.date())}`)},P=e=>{const t=h.q7.fromDate(new Date),a=h.q7.fromDate(new Date(e)),i=t.getDay(),s=a.getDay();if(s>=i)return r()((0,o.EJ)({year:t.getYear(),month:t.getMonth(),day:s}));const n=h.o7.fromYm(t.getYear(),t.getMonth()).next(1);return r()((0,o.EJ)({year:n.getYear(),month:n.getMonth(),day:s}))},Y=e=>{const t=Date.now(),a=r()().endOf("day").valueOf()+1;return window.setTimeout((()=>{try{e(a),Y(e)}catch(e){}}),a-t)},C=e=>{const t=Date.now(),a=r()().add(30,"minute").valueOf();return window.setTimeout((()=>{try{e(a),C(e)}catch(e){}}),a-t)};let _=r()().startOf("day"),j=_.year();Y((()=>{_=r()(),j=_.year()}));const L=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"solar";if(!e)return 0;if(e>=_.valueOf())return r()(e).diff(_,"day");if("lunar"===t){return P(e).diff(_,"day")}const a=r()(e),i=x(a),s=i.diff(_,"day");return s},z=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"solar";if(!e)return 0;if(e>=_.valueOf())return r()(e).diff(_,"day");if("lunar"===t){return $(e).diff(_,"day")}const a=r()(e),i=I(a,j),s=i.diff(_,"day");return s},G=e=>{const t=Math.floor(e/86400);e-=86400*t;const a=Math.floor(e/3600)%24;e-=3600*a;const i=Math.floor(e/60)%60;return{d:t,h:a,m:i,s:(e-=60*i)%60}};class F{views=new Map;execTime=0;execTimer=null;isPageVisible=!0;setViewVisibleInterval(){0!==this.views.size?this.isPageVisible?this.isViewVisible?this.setInterval(this.interval):this.setInterval(this.intervalOnViewOut):this.setPageVisibleInterval():this.setInterval(0)}setPageVisibleInterval(){0!==this.views.size?this.isPageVisible?this.setViewVisibleInterval():this.setInterval(this.intervalOnPageHide):this.setInterval(0)}setInterval(e){if(this.execTimer&&window.clearTimeout(this.execTimer),e<=0)return;let t=e;this.execTime&&(t=e-(Date.now()-this.execTime),t<0&&(t=0)),this.execTimer=window.setTimeout((async()=>{await this.execFn(),this.setInterval(e)}),t)}watchPageStatus(){T.addEventListener("statechange",(e=>{"hidden"===e.newState?this.isPageVisible=!1:this.isPageVisible=!0,this.setPageVisibleInterval()}))}onChangeViewVisible(){let e=!1;this.views.forEach((t=>{e||(e=t)})),this.isViewVisible=e,this.setViewVisibleInterval()}initIo(){this.io=new IntersectionObserver((e=>{e.forEach((e=>{this.views.has(e.target)&&this.views.set(e.target,e.intersectionRatio>0)})),this.onChangeViewVisible()}),{threshold:[0]})}constructor(e,t){if(!t.interval)throw new Error("请设置间隔时间");this.interval=t.interval,this.intervalOnViewOut=t.intervalOnViewOut,this.intervalOnPageHide=t.intervalOnPageHide,this.execFn=async()=>{try{await e()}catch(e){}this.execTime=Date.now()},t.immediate&&this.execFn(),this.watchPageStatus(),this.initIo(),t.view&&this.addView(t.view)}addView(e){this.views.set(e,!1),this.io.observe(e)}removeView(e){this.views.delete(e),this.io.unobserve(e),this.onChangeViewVisible()}}},54765:(e,t,a)=>{a.d(t,{S:()=>s});var i=a(74003);const s={fontColor:"rgba(248, 248, 248, 1)",bgType:"image",bgColor:(0,a(13409).zY)(),bgImageColor:"",bgImage:{large:`${GlobalGetApi}${i.c1}/widget-background/background18_larg.jpg`,medium:`${GlobalGetApi}${i.c1}/widget-background/background18_medium.jpg`,small:`${GlobalGetApi}${i.c1}/widget-background/background18_small.jpg`},bgMask:20}},96201:(e,t,a)=>{a.r(t),a.d(t,{useTimerYearStore:()=>m,widgetInfo:()=>c});var i=a(10435),s=a(54765),r=a(24581),n=a(13409),o=a(80661),h=a.n(o),d=a(84522),l=a(94119);const c=(0,r.E0)("widget-timer-year"),g=()=>h()().endOf("year").valueOf(),u=e=>{const t=h()(e+1).diff(h()(),"second");return(0,n.f8)(t)},b=()=>{const e=h()(),t=e.endOf("year").diff(e.startOf("year"),"day")+1,a=e.diff(e.startOf("year"),"day");return Number((a/t*100).toFixed(2))},f=g(),m=(0,i.Q_)(d.BU.timerYear,{syncStorage:{watch:["timerStyle"]},syncCloud:{watch:["timerStyle"]},state:()=>({modalShow:!1,modalState:{size:"s",openType:"add"},timerStyle:s.S,yearEndTime:f,year:h()().year(),gapTime:u(f),percent:b()}),actions:{updateDay(){this.yearEndTime=g(),this.year=h()().year(),this.percent=b()},updateGapDate(){this.gapTime=u(this.yearEndTime)},openModal(e){this.modalState=e,this.setModal(!0)},closeModal(){this.setModal(!1)},setModal(e){l.G.setStatus(r.Rm.timerYear,e),this.modalShow=e},saveStyle(e){this.timerStyle={...e}}}});(0,n.ST)((()=>{m().updateDay()})),setInterval((()=>{m().updateGapDate()}),1e3)}}]);